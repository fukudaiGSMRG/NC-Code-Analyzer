# 🚀 NC_コードアナライザー_Pro_Ver5_4.exe (NCプログラム検証ツール)

![使用イメージ](https://github.com/user-attachments/assets/a7687099-4f3c-40eb-82bd-e380d0e471a8)

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue)](https://www.python.org/)
[![Platform](https://img.shields.io/badge/Platform-Windows-0078D6)](https://www.microsoft.com/windows)
[![License](https://img.shields.io/badge/License-MIT-green)](./LICENSE)

**インストール不要、即起動。完全オフラインで動作する、製造現場のためのNCプログラム解析・検証ツールです。**

作業機械（マシニングセンタ・旋盤）のNCデータ（Gコード）をドラッグ＆ドロップするだけで、早送り/切削送りの詳細な認識範囲、回転数、送り速度を瞬時に解析します。
「現場のヒヤリハット撲滅」と「確認作業の工数削減」を強力に支援します。

---

## 📥 ダウンロード (Download)

Python環境は不要です。以下より最新の `.exe` ファイルをダウンロードしてご使用ください。

1.  **[最新版 (Ver 5.5) をダウンロード](https://github.com/fukudaiGSMRG/NC-Code-Analyzer/releases/tag/%EF%BD%965.5.0))**
2.  任意のフォルダに保存してください。
3.  `NC_コードアナライザー_Pro_Ver5_4.exe` をダブルクリックで起動します。

> [!WARNING]
> **⚠️ 起動時のお願い**
> 1.  **セキュリティ警告について**: Windowsの仕様により「発行元不明の警告」が出る場合があります。その際は「詳細情報」→「実行」を選択してください。（危険なコードは含まれていません）
> 2.  **起動時間について**: 仕組み上、ダブルクリックから画面表示までに **5秒〜15秒程度** かかる場合があります。故障ではありませんので、連打せずにお待ちください。

---

## 🆕 最新アップデート (Ver.5.4)

今回のバージョンアップで、**旋盤加工（溝入れ等）の解析精度が劇的に向上**しました。

* **🔧 モーダル座標追跡機能の実装**
    * これまでは座標記載がない行は「移動なし」としていましたが、Ver.5.4からは前の行の座標（モーダル情報）を追跡。
    * `G01 Z...` のように片側の軸しか記述がないブロックでも、現在のX座標を含めた正しい切削範囲として認識します。
* **⏱️ ドウェル時間(G04)のログ出力対応**
    * `G04` で指定される一時停止時間を自動検出し、ログに「秒数/ミリ秒数」として明示します。
* **🐛 解析ロジックの修正**
    * コメント `()` 内に数値が含まれる場合の誤検知バグを修正。
    * 旋盤モード時、G04のX値を「座標」として誤認しないよう除外処理を強化。

---

## ✨ 主な機能 (Features)

現場の「ヒヤリハット」を撲滅し、確認作業を効率化するための機能を搭載しています。

| 機能 | 詳細 |
| :--- | :--- |
| **⚡ 早送り/切削の完全分離** | G00（位置決め）とG01/02/03（加工）の移動範囲を別々に算出。「早送りで突っ込んでいないか」を一目で判別可能です。 |
| **📊 ブロック別リスト** | 注釈 `(COMMENT)` を自動検出し、工程単位でリスト化。Excelのような見やすいテーブル表示。 |
| **📏 範囲チェック** | 機械のリミット値や干渉ラインを設定し、プログラムがその範囲を超えていないか自動判定。 |
| **📈 ダッシュボード** | プログラム全体の「XYZ最大最小」「最高回転数」「最大送り」を常時トップに表示。 |
| **💾 CSVエクスポート** | 解析結果をCSVレポートとして出力可能。品質管理の記録として活用できます。 |
| **🔒 完全オフライン** | 外部通信を行いません。機密性の高い図面データやノウハウを含むプログラムも安心して解析できます。 |

### 対応制御装置 (Supported Controllers)
* **FANUC** (Vertical Lathe / Turning) - G50/G96チェック対応
* **OSP** (Okuma 五面加工機)
* **TOSNUC** (Toshiba 横中ぐり盤)

---

## 👨‍💻 製作者について (Author)

**長崎の町工場発。「現場のドメイン知識 × 生成AI」**

5軸・縦旋盤のNCプログラムを組みながら、品質管理を担っています。
プログラミングは専門外ですが、**バイブコーディング（Vibe Coding）**を駆使して、現場独自の業務改善ツールを自作しています。

* 🏭 **Main Job:** 5-Axis / Vertical Lathe NC Programmer (Mastercam user)
* 🐍 **Tech Stack:** Python (Tkinter, Pandas), AI Prompt Engineering
* 🛠️ **Current Project:** NCデータ解析・干渉チェックツールの開発

> 「中小製造業でも、AIを使えばここまで内製DXできる」を実践中。
> 現場のカイゼンや技術について、ぜひ情報交換しましょう！

---

<details>
<summary><strong>💻 開発者向け情報 (For Developers) ※クリックで展開</strong></summary>

ソースコードから実行、または自身でビルドを行う場合の手順です。

### 必要要件
* Python 3.8+
* `tkinterdnd2`

### セットアップと実行

```bash


# 依存ライブラリのインストール
pip install tkinterdnd2

# アプリの実行
python nc_checker_ultimate_v5_4.py



